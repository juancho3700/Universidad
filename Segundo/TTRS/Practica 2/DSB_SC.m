% DSB_SC.m: suppressed carrier with (possible) freq and phase offsetstime=0.2; Ts=1/10000;                           % sampling interval and timet=Ts:Ts:time;                                   % define a "time" vector fc=1000; c=cos(2*pi*fc*t);                      % define carrier at freq fcm=.7*sin(2*pi*20*t)+.3*cos(2*pi*70*t);          % create "message" x = c.*m;                                       % modulate fd = 0; phi = 0;                                % freq & phase offsetsc2 = cos(2*pi*(fc+fd)*t+phi);                   % create cosine for demodulationb = x.*c2;                                      % demodulate received signalfbe=[0 0.05 0.25 1]; damps=[1 1 0 0]; L=20;     % low pass filter design h=firpm(L,fbe,damps);                           % impulse response of LPFmest=2*filter(h,1,b);                           % LPF the demodulated signal% generate the figurefigure(1)subplot(4,1,1), plot(t,m)ylabel('amplitude'); title('(a) message signal');axis([0,0.1,-1.5 1.5])subplot(4,1,2), plot(t,x,'c')ylabel('amplitude'); title('(b) modulated signal');axis([0,0.1, -1.5,1.5])subplot(4,1,3), plot(t,b,'m')ylabel('amplitude'); title('(c) demodulated signal');axis([0,0.1, -1.5,1.5])subplot(4,1,4), plot(t,mest,'r')ylabel('amplitude'); title('(d) recovered message');axis([0,0.1, -1.5, 1.5])xlabel('seconds');% this shows things a bit more clearly (but won't print well)figure(2)plot(t,x,'c') hold on plot(t,m) plot(t,mest,'r') ylabel('amplitude') xlabel('seconds') title('cyan=modulated signal, blue=message, red=recovered message')hold off% Question 4% Hay aliasing, así que al multiplicar por la sinusoide demoduladora% aparecen componentes cerca el 0 que el filtro paso bajo deja pasar% Al cambiar la fase del coseno que se utiliza para demodular la señal,% también cambia el factor por el que multiplicas la señal modulada;% llegando al punto de que cos (pi/2) = 0 => si la fase del coseno por el% que se multiplica es múltiplo impar de pi/2 la señal se anula% completamente, y si es múltiplo impar de pi la señal se demodula% invertida respecto al eje x