% plotacf(r,Ts) plots the TF of the autocorrelation function r% Ts = time (in seconds) between adjacent samples in rfunction plotacf(r,Ts)N = length(r);                                    % length of the ACF rt = Ts*(-(N-1)/2:(N-1)/2);                        % define a time vector ssf = (-N/2:N/2-1)/(Ts*N);                        % frequency vectorfx  = fft(r(1:N));                                % do DFT/FFTfxs = fftshift(fx);                               % shift it for plottingsubplot(2,1,1), plot(t,r,'.-')                    % plot the waveformxlabel('time (seconds)'); ylabel('amplitude')     % label the axessubplot(2,1,2), plot(ssf,abs(fxs),'r')            % plot magnitude spectrumxlabel('frequency (Hz)'); ylabel('magnitude')     % label the axes%verify parseval equalize power using%sum(abs(fxs).^2)/N%sum(abs(x).^2)% use axis([0,2,-1.1,1.1]) for specsquare.eps